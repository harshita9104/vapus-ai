(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[854],{1118:(e,s,l)=>{"use strict";l.d(s,{A:()=>r});var a=l(5155);function r(e){let{onClick:s,name:l="Remove"}=e;return(0,a.jsx)("button",{type:"button",onClick:s,className:"mt-2 px-2 py-1 bg-red-500 text-white rounded text-xs hover:bg-red-600 cursor-pointer",children:l})}l(2115)},1480:(e,s,l)=>{"use strict";l.r(s),l.d(s,{default:()=>h});var a=l(5155),r=l(2115),n=l(1440),i=l(9725),t=l(9994),c=l(5255),o=l(3024),d=l(5799),u=l(3093),m=l(2417),p=l(8525),g=l(1118),x=l(5695);let h=()=>{let e=(0,x.useRouter)(),[s,l]=(0,r.useState)("form"),[h,y]=(0,r.useState)(!0),[v,b]=(0,r.useState)({}),[f,j]=(0,r.useState)([]),[N,P]=(0,r.useState)({}),[S,w]=(0,r.useState)([]),[E,k]=(0,r.useState)([]),[C,T]=(0,r.useState)([{key:"",value:""}]),[L,I]=(0,r.useState)({name:"",pluginType:"",pluginService:"",scope:"",editable:!0}),[R,_]=(0,r.useState)(null);(0,r.useEffect)(()=>{(async()=>{try{y(!0);let e=await u.N.getEnums(),s=(e.enumResponse||[]).find(e=>"ResourceScope"===e.name);s&&s.value&&k(s.value);let l=e.pluginTypeMap||[];w(l);let a=l.map(e=>e.pluginTypes);j(a),console.log("Plugin types loaded:",a),console.log("Resource scopes loaded:",null==s?void 0:s.value)}catch(e){console.error("Failed to fetch plugin data:",e),_(e.message),d.oR.error("Failed to fetch plugin configuration data")}finally{y(!1)}})()},[]),(0,r.useEffect)(()=>{if("SELECT_PLUGIN_TYPE"!==L.pluginType){let e=S.find(e=>e.pluginTypes===L.pluginType);e&&e.services?(P(e.services),I(e=>({...e,pluginService:"SELECT_SERVICE_PROVIDER"}))):P({})}else P({})},[L.pluginType,S]);let z=e=>{let{name:s,value:l,type:a,checked:r}=e.target,n=s.split(".");"spec"===n[0]&&n.shift(),I(e=>{let s={...e},i=s;if(1===n.length)return"checkbox"===a?i[n[0]]=r:i[n[0]]=l,s;for(let e=0;e<n.length-1;e++)i[n[e]]||(i[n[e]]={}),i=i[n[e]];let t=n[n.length-1];return"checkbox"===a?i[t]=r:i[t]=l,s})},A=e=>{let s=[...C];s.splice(e,1),T(s)},O=(e,s,l)=>{let a=[...C];a[e][s]=l,T(a)},F=async e=>{var s;e.preventDefault();let l=C.filter(e=>""!==e.key.trim()),a={...L,networkParams:v,dynamicParams:l};if(console.log("Combined form data:",a),(null===(s=a.networkParams)||void 0===s?void 0:s.credentials)&&Object.keys(a.networkParams.credentials).length>0){let e=JSON.stringify(a.networkParams.credentials||{});a.data=e}let r="SELECT_SERVICE_PROVIDER"===a.pluginService?"":a.pluginService,n={spec:{name:a.name,scope:a.scope,pluginType:a.pluginType,pluginService:r,editable:a.editable,networkParams:a.networkParams,dynamicParams:a.dynamicParams}};console.log("Full API Payload:",n),await G(n)},G=async s=>{try{y(!0);let l=(await o.pV.getpluginsForm(s)).result;l?(d.oR.success("Plugin Created","".concat(l.resource," Plugin created successfully.")),setTimeout(()=>{e.push("/settings/plugins")},1e3)):d.oR.success("Plugin Created","Plugin created successfully.")}catch(e){console.error("Error sending API request:",e),d.oR.error("Plugin Creation Failed")}finally{y(!1)}};return(0,a.jsx)("div",{className:"bg-zinc-800 flex h-screen",children:(0,a.jsxs)("div",{className:"overflow-y-auto scrollbar h-screen w-full",children:[(0,a.jsx)(n.A,{sectionHeader:"Create Plugins",hideBackListingLink:!1,backListingLink:"./"}),(0,a.jsx)(t.A,{}),(0,a.jsx)(c.A,{isLoading:h,isOverlay:!0}),(0,a.jsx)("div",{className:"flex-grow p-4 overflow-y-auto w-full",children:(0,a.jsx)("section",{className:"space-y-2",children:(0,a.jsxs)("div",{className:"max-w-6xl mx-auto bg-[#1b1b1b] shadow rounded-lg p-2",children:[(0,a.jsx)("div",{className:"text-gray-100 mb-2 flex justify-center",children:(0,a.jsx)("button",{id:"formSpecB",className:"whitespace-nowrap border-b-2 py-2 px-2 text-md font-medium focus:outline-none ml-4 border-orange-700 text-orange-700 font-semibold",onClick:()=>l("form"),suppressHydrationWarning:!0,children:"Form"})}),"yaml"===s?(0,a.jsx)("div",{id:"yamlSpec"}):(0,a.jsx)("div",{id:"formSpec",children:(0,a.jsxs)("form",{id:"pluginForm",className:"space-y-2 border border-zinc-500 rounded-md text-gray-100 p-2",onSubmit:F,children:[(0,a.jsxs)("fieldset",{className:"p-4 rounded",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"labels",children:"Name"}),(0,a.jsx)("input",{id:"name",name:"name",type:"text",placeholder:"Enter plugin name",className:"form-input-field p-2 rounded-md bg-zinc-700 placeholder-gray-300 shadow-sm outline-none border-none text-sm p-1 mt-2 w-full",value:L.name,onChange:z,required:!0,suppressHydrationWarning:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"labels",children:"Scope"}),(0,a.jsxs)("select",{name:"scope",className:"mt-1 w-full flex justify-between items-center bg-zinc-800 px-4 py-2 text-sm font-medium focus:ring-1 focus:ring-orange-700",value:L.scope,onChange:z,suppressHydrationWarning:!0,children:[(0,a.jsx)("option",{value:"SELECT_SCOPE",children:"Select Scope"}),E.map(e=>(0,a.jsx)("option",{value:e,children:(0,m.E)(e)},e))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"labels",children:"Plugin Type"}),(0,a.jsxs)("select",{name:"pluginType",className:"mt-1 w-full flex justify-between items-center bg-zinc-800 px-4 py-2 text-sm font-medium focus:ring-1 focus:ring-orange-700",value:L.pluginType,onChange:z,suppressHydrationWarning:!0,children:[(0,a.jsx)("option",{value:"SELECT_PLUGIN_TYPE",children:"Select Plugin Type"}),null==f?void 0:f.map(e=>(0,a.jsx)("option",{value:e,children:(0,m.E)(e)},e))]})]})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"labels",children:"Service Provider"}),(0,a.jsx)("div",{className:"mt-2",children:""===L.pluginType?(0,a.jsx)("div",{className:"text-gray-400 italic",children:"Please select a Plugin Type first to see available Service Providers"}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"rounded mb-4 max-h-36 scrollbar overflow-y-auto",children:(0,a.jsx)("div",{className:"grid grid-cols-4 sm:grid-cols-4 md:grid-cols-6 lg:grid-cols-6 gap-4",children:Object.keys(N).map(e=>(0,a.jsx)("div",{className:"border rounded-md p-3 cursor-pointer transition-all duration-200 flex flex-col items-center ".concat(L.pluginService===e?"border-orange-700 bg-zinc-700":"border-zinc-600 hover:border-orange-700 hover:bg-zinc-700"),onClick:()=>{z({target:{name:"pluginService",value:e,type:"select"}})},children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"h-8 w-8 flex items-center justify-center",children:(0,a.jsx)("img",{src:N[e],alt:e,className:"max-h-full max-w-full object-contain"})}),(0,a.jsx)("div",{className:"tooltip text-sm font-medium",tooltip:(0,m.E)(e),children:(0,m.m)((0,m.E)(e),7)})]})},e))})}),(0,a.jsx)("input",{type:"hidden",name:"pluginService",value:L.pluginService})]})})]}),(0,a.jsxs)("details",{className:"border border-zinc-500 p-4 rounded mb-4",children:[(0,a.jsx)("summary",{className:"text-lg font-semibold cursor-pointer",children:"Network Credentials"}),(0,a.jsx)(i.A,{onParamsChange:e=>{JSON.stringify(v)!==JSON.stringify(e)&&b(e)}})]}),(0,a.jsxs)("details",{className:"shadow-sm border border-zinc-500 rounded-md shadow-sm p-4 mb-4",children:[(0,a.jsx)("summary",{className:"text-lg font-semibold text-gray-100 cursor-pointer",children:"Dynamic Parameters"}),(0,a.jsxs)("fieldset",{className:"rounded mb-4",children:[(0,a.jsx)("div",{id:"dynamicParamsContainer",children:C.map((e,s)=>(0,a.jsxs)("div",{className:"border p-3 rounded mb-3",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-2 gap-4 mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"labels",children:"Key"}),(0,a.jsx)("input",{type:"text",placeholder:"Enter Key",className:"form-input-field p-2 rounded-md bg-zinc-700 placeholder-gray-300 shadow-sm outline-none border-none text-sm p-1 mt-2 w-full",value:e.key,onChange:e=>O(s,"key",e.target.value),suppressHydrationWarning:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"labels",children:"Value"}),(0,a.jsx)("input",{type:"text",placeholder:"Enter Value",className:"form-input-field p-2 rounded-md bg-zinc-700 placeholder-gray-300 shadow-sm outline-none border-none text-sm p-1 mt-2 w-full",value:e.value,onChange:e=>O(s,"value",e.target.value),suppressHydrationWarning:!0})]})]}),s>0&&(0,a.jsx)(g.A,{onClick:()=>A(s)})]},"param-".concat(s)))}),(0,a.jsx)(p.A,{name:"+ Add Parameter",onClick:()=>{T([...C,{key:"",value:""}])}})]})]})]}),(0,a.jsx)("div",{className:"mt-4 flex justify-end space-x-2",children:(0,a.jsx)("button",{type:"submit",className:"px-6 py-2 bg-orange-700 text-white rounded-md shadow hover:bg-pink-900",suppressHydrationWarning:!0,disabled:h,children:h?(0,a.jsxs)("svg",{className:"animate-spin h-6 w-6 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):"Create Plugin"})})]})})]})})})]})})}},3024:(e,s,l)=>{"use strict";l.d(s,{L9:()=>c,S:()=>t,VA:()=>n,pV:()=>i});var a=l(6403);let r={PLUGINS:"/api/v1alpha1/plugins"},n={getPlugins:()=>(0,a.Zq)(r.PLUGINS,"GET",null),getPluginsId:e=>(0,a.Zq)("".concat(r.PLUGINS,"/").concat(e),"GET",null)},i={getpluginsForm:e=>(0,a.Zq)(r.PLUGINS,"POST",e)},t={getPluginsUpdateForm:e=>(0,a.Zq)(r.PLUGINS,"PUT",e)},c={getPluginsArchive:e=>(0,a.Zq)("".concat(r.PLUGINS,"/").concat(e),"DELETE",null)}},8053:(e,s,l)=>{Promise.resolve().then(l.bind(l,1480))},8525:(e,s,l)=>{"use strict";l.d(s,{A:()=>r});var a=l(5155);function r(e){let{name:s,onClick:l}=e;return(0,a.jsx)("button",{type:"button",onClick:l,className:"mt-2 px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 cursor-pointer",suppressHydrationWarning:!0,children:s})}l(2115)}},e=>{var s=s=>e(e.s=s);e.O(0,[5552,5441,1440,169,8441,1684,7358],()=>s(8053)),_N_E=e.O()}]);