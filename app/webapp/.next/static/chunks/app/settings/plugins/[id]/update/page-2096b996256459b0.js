(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3895],{1118:(e,s,l)=>{"use strict";l.d(s,{A:()=>n});var a=l(5155);function n(e){let{onClick:s,name:l="Remove"}=e;return(0,a.jsx)("button",{type:"button",onClick:s,className:"mt-2 px-2 py-1 bg-red-500 text-white rounded text-xs hover:bg-red-600 cursor-pointer",children:l})}l(2115)},3003:(e,s,l)=>{"use strict";l.r(s),l.d(s,{default:()=>h});var a=l(5155),n=l(2115),i=l(1440),r=l(9725),t=l(9994),c=l(2417),d=l(5255),o=l(3024),u=l(5799),m=l(3093),p=l(8525),g=l(1118),x=l(5695);let h=e=>{let{params:s}=e,l=(0,x.useRouter)(),h=(0,n.use)(s),y=(null==h?void 0:h.id)?String(h.id).trim():"",[v,b]=(0,n.useState)("form"),[f,j]=(0,n.useState)(!0),[N,w]=(0,n.useState)({}),[P,S]=(0,n.useState)(null),[k,T]=(0,n.useState)([]),[C,E]=(0,n.useState)([]),[A,z]=(0,n.useState)({}),[I,L]=(0,n.useState)([]),[U,O]=(0,n.useState)([{key:"",value:""}]),[H,F]=(0,n.useState)({name:"",pluginType:"",pluginService:"",scope:"",editable:!0}),[R,W]=(0,n.useState)(null);(0,n.useEffect)(()=>{(async()=>{try{j(!0);let s=await m.N.getEnums(),l=(s.enumResponse||[]).find(e=>"ResourceScope"===e.name);l&&l.value&&E(l.value);let a=s.pluginTypeMap||[];L(a);let n=a.map(e=>e.pluginTypes);if(T(n),y){var e;let s=await o.VA.getPluginsId(y),l=(null===(e=s.output)||void 0===e?void 0:e[0])||{};if(l){let e={name:l.name||"",pluginType:l.pluginType||"",pluginService:l.pluginService||"",scope:l.scope||"DOMAIN_SCOPE",editable:!1!==l.editable};if(F(e),l.networkParams&&(w(l.networkParams),S(l.networkParams)),l.dynamicParams&&l.dynamicParams.length>0&&O(l.dynamicParams),l.pluginType){let e=a.find(e=>e.pluginTypes===l.pluginType);e&&e.services&&z(e.services)}}}else console.error("No plugin ID provided"),u.oR.error("No plugin ID provided for update")}catch(e){console.error("Failed to fetch plugin data:",e),W(e.message),u.oR.error("Failed to fetch plugin configuration data")}finally{j(!1)}})()},[y]),(0,n.useEffect)(()=>{if(""!==H.pluginType){let e=I.find(e=>e.pluginTypes===H.pluginType);e&&e.services?(z(e.services),Object.keys(e.services).includes(H.pluginService)||F(e=>({...e,pluginService:""}))):z({})}else z({})},[H.pluginType,I]);let G=e=>{let{name:s,value:l,type:a,checked:n}=e.target,i=s.split(".");"spec"===i[0]&&i.shift(),F(e=>{let s={...e},r=s;if(1===i.length)return"checkbox"===a?r[i[0]]=n:r[i[0]]=l,s;for(let e=0;e<i.length-1;e++)r[i[e]]||(r[i[e]]={}),r=r[i[e]];let t=i[i.length-1];return"checkbox"===a?r[t]=n:r[t]=l,s})},q=e=>{let s=[...U];s.splice(e,1),O(s)},_=(e,s,l)=>{let a=[...U];a[e][s]=l,O(a)},D=async e=>{var s;e.preventDefault();let l=U.filter(e=>""!==e.key.trim()),a={...H,networkParams:N,dynamicParams:l};if((null===(s=a.networkParams)||void 0===s?void 0:s.credentials)&&Object.keys(a.networkParams.credentials).length>0){let e=JSON.stringify(a.networkParams.credentials||{});a.data=e}let n=a.pluginService||"",i={spec:{pluginId:y,name:a.name,scope:a.scope,pluginType:a.pluginType,pluginService:n,editable:a.editable,networkParams:a.networkParams,dynamicParams:a.dynamicParams}};await V(i)},V=async e=>{try{j(!0);let s=(await o.S.getPluginsUpdateForm(e,y)).result;s?(u.oR.success("Plugin Updated","".concat(s.resource," Plugin updated successfully.")),setTimeout(()=>{l.push("/settings/plugins/".concat(y))},1e3)):(u.oR.success("Plugin Updated","Plugin updated successfully."),setTimeout(()=>{l.push("/settings/plugins/".concat(y))},1e3))}catch(e){console.error("Error sending API request:",e),u.oR.error("Plugin Update Failed")}finally{j(!1)}};return(0,a.jsx)("div",{className:"bg-zinc-800 flex h-screen",children:(0,a.jsxs)("div",{className:"overflow-y-auto scrollbar h-screen w-full",children:[(0,a.jsx)(i.A,{sectionHeader:"Update Plugin",hideBackListingLink:!1,backListingLink:"./"}),(0,a.jsx)(t.A,{}),(0,a.jsx)(d.A,{isLoading:f,isOverlay:!0}),(0,a.jsx)("div",{className:"flex-grow p-4 overflow-y-auto w-full",children:(0,a.jsx)("section",{className:"space-y-2",children:(0,a.jsxs)("div",{className:"max-w-6xl mx-auto bg-[#1b1b1b] shadow rounded-lg p-2",children:[(0,a.jsx)("div",{className:"text-gray-100 mb-2 flex justify-center",children:(0,a.jsx)("button",{id:"formSpecB",className:"whitespace-nowrap border-b-2 py-2 px-2 text-md font-medium focus:outline-none ml-4 border-orange-700 text-orange-700 font-semibold",onClick:()=>b("form"),suppressHydrationWarning:!0,children:"Form"})}),(0,a.jsx)("div",{id:"formSpec",children:(0,a.jsxs)("form",{id:"pluginForm",className:"space-y-2 border border-zinc-500 rounded-md text-gray-100 p-2",onSubmit:D,children:[(0,a.jsxs)("fieldset",{className:"p-4 rounded",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"labels",children:"Name"}),(0,a.jsx)("input",{id:"name",name:"name",type:"text",placeholder:"Enter plugin name",className:"form-input-field p-2 rounded-md bg-zinc-700 placeholder-gray-300 shadow-sm outline-none border-none text-sm p-1 mt-2 w-full",value:H.name,onChange:G,required:!0,suppressHydrationWarning:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"labels",children:"Scope"}),(0,a.jsxs)("select",{name:"scope",className:"mt-1 w-full flex justify-between items-center bg-zinc-800 px-4 py-2 text-sm font-medium focus:ring-1 focus:ring-orange-700",value:H.scope,onChange:G,suppressHydrationWarning:!0,children:[(0,a.jsx)("option",{value:"",children:"Select Scope"}),null==C?void 0:C.map(e=>(0,a.jsx)("option",{value:e,children:(0,c.E)(e)},e))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"labels",children:"Plugin Type"}),(0,a.jsxs)("select",{name:"pluginType",className:"mt-1 w-full flex justify-between items-center bg-zinc-800 px-4 py-2 text-sm font-medium focus:ring-1 focus:ring-orange-700",value:H.pluginType,onChange:G,suppressHydrationWarning:!0,disabled:!0,children:[(0,a.jsx)("option",{value:"",children:"Select Plugin Type"}),null==k?void 0:k.map(e=>(0,a.jsx)("option",{value:e,children:(0,c.E)(e)},e))]})]})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"labels",children:"Service Provider"}),(0,a.jsx)("div",{className:"mt-2",children:H.pluginType?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"rounded mb-4 max-h-36 scrollbar overflow-y-auto",children:(0,a.jsx)("div",{className:"grid grid-cols-4 sm:grid-cols-4 md:grid-cols-6 lg:grid-cols-6 gap-4",children:Object.keys(A).map(e=>(0,a.jsx)("div",{className:"border rounded-md p-3 cursor-pointer transition-all duration-200 flex flex-col items-center ".concat(H.pluginService===e?"border-orange-700 bg-zinc-700":"border-zinc-600 hover:border-orange-700 hover:bg-zinc-700"),onClick:()=>{},children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"h-8 w-8 flex items-center justify-center",children:(0,a.jsx)("img",{src:A[e],alt:e,className:"max-h-full max-w-full object-contain"})}),(0,a.jsx)("div",{className:"tooltip text-sm font-medium",tooltip:(0,c.E)(e),children:(0,c.m)((0,c.E)(e),7)})]})},e))})}),(0,a.jsx)("input",{type:"hidden",name:"pluginService",value:H.pluginService})]}):(0,a.jsx)("div",{className:"text-gray-400 italic",children:"Please select a Plugin Type first to see available Service Providers"})})]}),(0,a.jsxs)("details",{className:"border border-zinc-500 p-4 rounded mb-4",children:[(0,a.jsx)("summary",{className:"text-lg font-semibold cursor-pointer",children:"Network Credentials"}),(0,a.jsx)(r.A,{onParamsChange:e=>{JSON.stringify(N)!==JSON.stringify(e)&&w(e)},initialParams:P})]}),(0,a.jsxs)("details",{className:"shadow-sm border border-zinc-500 rounded-md shadow-sm p-4 mb-4",children:[(0,a.jsx)("summary",{className:"text-lg font-semibold text-gray-100 cursor-pointer",children:"Dynamic Parameters"}),(0,a.jsxs)("fieldset",{className:"rounded mb-4",children:[(0,a.jsx)("div",{id:"dynamicParamsContainer",children:U.map((e,s)=>(0,a.jsxs)("div",{className:"border p-3 rounded mb-3",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-2 gap-4 mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"labels",children:"Key"}),(0,a.jsx)("input",{type:"text",placeholder:"Enter Key",className:"form-input-field p-2 rounded-md bg-zinc-700 placeholder-gray-300 shadow-sm outline-none border-none text-sm p-1 mt-2 w-full",value:e.key,onChange:e=>_(s,"key",e.target.value),suppressHydrationWarning:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"labels",children:"Value"}),(0,a.jsx)("input",{type:"text",placeholder:"Enter Value",className:"form-input-field p-2 rounded-md bg-zinc-700 placeholder-gray-300 shadow-sm outline-none border-none text-sm p-1 mt-2 w-full",value:e.value,onChange:e=>_(s,"value",e.target.value),suppressHydrationWarning:!0})]})]}),s>0&&(0,a.jsx)(g.A,{onClick:()=>q(s)})]},"param-".concat(s)))}),(0,a.jsx)(p.A,{name:"+ Add Parameter",onClick:()=>{O([...U,{key:"",value:""}])}})]})]})]}),(0,a.jsx)("div",{className:"mt-4 flex justify-end space-x-2",children:(0,a.jsx)("button",{type:"submit",className:"px-6 py-2 bg-orange-700 text-white rounded-md shadow hover:bg-pink-900",suppressHydrationWarning:!0,disabled:f,children:f?(0,a.jsxs)("svg",{className:"animate-spin h-6 w-6 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):"Submit"})})]})})]})})})]})})}},3024:(e,s,l)=>{"use strict";l.d(s,{L9:()=>c,S:()=>t,VA:()=>i,pV:()=>r});var a=l(6403);let n={PLUGINS:"/api/v1alpha1/plugins"},i={getPlugins:()=>(0,a.Zq)(n.PLUGINS,"GET",null),getPluginsId:e=>(0,a.Zq)("".concat(n.PLUGINS,"/").concat(e),"GET",null)},r={getpluginsForm:e=>(0,a.Zq)(n.PLUGINS,"POST",e)},t={getPluginsUpdateForm:e=>(0,a.Zq)(n.PLUGINS,"PUT",e)},c={getPluginsArchive:e=>(0,a.Zq)("".concat(n.PLUGINS,"/").concat(e),"DELETE",null)}},4334:(e,s,l)=>{Promise.resolve().then(l.bind(l,3003))},8525:(e,s,l)=>{"use strict";l.d(s,{A:()=>n});var a=l(5155);function n(e){let{name:s,onClick:l}=e;return(0,a.jsx)("button",{type:"button",onClick:l,className:"mt-2 px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 cursor-pointer",suppressHydrationWarning:!0,children:s})}l(2115)}},e=>{var s=s=>e(e.s=s);e.O(0,[5552,5441,1440,169,8441,1684,7358],()=>s(4334)),_N_E=e.O()}]);